{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold mb-2">Dashboard</h1>

<p class="mb-6 text-gray-600 dark:text-gray-400">
    Welcome, {{ request.user.username }}
</p>

{% if perms.posts.add_post %}
<a href="{% url 'posts:post-create' %}"
   class="inline-block mb-6 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">
    ➕ Create new post
</a>
{% endif %}

{% if posts %}
    <div class="space-y-4">
        {% for post in posts %}
            <div class="bg-white dark:bg-gray-800 p-4 rounded shadow flex justify-between items-center">
                
                <div>
                    <h3 class="font-semibold text-lg">{{ post.title }}</h3>
                    <p class="text-sm text-gray-500">
                        Status:
                        <span class="font-medium capitalize">
                            {{ post.status }}
                        </span>
                    </p>
                </div>

                <div class="flex gap-4 text-sm items-center">
                    <!-- View: everyone -->
                    <a href="{% url 'posts:post-detail' post.slug %}"
                       class="text-blue-500 hover:underline">
                        View
                    </a>

                    <!-- Edit: only author with permission -->
                    {% if perms.posts.change_post and post.author == request.user %}
                        <a href="{% url 'posts:post-edit' post.slug %}"
                           class="text-yellow-500 hover:underline">
                            Edit
                        </a>
                    {% endif %}

                    <!-- Delete: only author with permission -->
                    {% if perms.posts.delete_post and post.author == request.user %}
                        <a href="{% url 'posts:post-delete' post.slug %}"
                           class="text-red-500 hover:underline">
                            Delete
                        </a>
                    {% endif %}

                    <!-- Publish: reviewers/admins only -->
                    {% if perms.posts.change_post and post.status == "review" %}
                        <a href="{% url 'posts:publish' post.slug %}"
                           class="text-green-500 hover:underline">
                            Publish
                        </a>
                    {% endif %}
                </div>

            </div>
        {% endfor %}
    </div>
{% else %}
    <p class="text-gray-500">
        You haven’t written any posts yet.
    </p>
{% endif %}
{% endblock %}
